---
title: "Tarea3"
author: "Sara, Valeria, Ivan, Alberto"
format: pdf
editor: source
---

# Tarea 3.

```{r message=FALSE}
library(ggplot2)
library(tidyverse)
library(patchwork)
library(kableExtra)
```

1. Calcular el estimador de Monte Carlo de la integral
$$\int_0^{\pi/3}\text{sin}(t)dt$$
 y comparar el estimador con el valor exacto de la integral.
 
 2. Escribir una función para calcular el estimador de Monte Carlo de la función de distribución $\mathcal{Be}(3,3)$ y usar la función para estimar $F(x)$ para $x = 0.1,...,0.9$. Comparar los estimados con los valores obtenidos con la función *pbeta* de *R*.
 
 3. Usar integración Montse Carlo para estimar:
 $$\int_0^1\frac{e^{-x}}{1+x^2}dx$$
 y calcular el tamaño de muestra  necesario para obtener un error de estimación máximo de $\pm 0.001$.
 
 4. Sea $\hat\theta_{IS}$ el estimador  de importancia de $\theta=\int g(x)dx$, donde la función de mportancia $f$ es una densidad. Probar que si $g(x)/f(x)$ es acotada, entonces la varianza del estimador de muestreo por importancia $\hat\sigma_{IS}$ es infinita.
 
 5. Enconrar dos funciones de importancia $f_1$ y $f_2$ que tengan soporte en $(1,\infty)$ y estén 'cerca' de:
$$g(x)=\frac{x^2}{\sqrt{2\pi}}e^{x^2/2}, x>1$$

¿Cuál de las dos funciones de importancia debe producir la varianza más pequeña para estimar la integral siguiente por muestreo de importancia?

$$\int_1^\infty\frac{x^2}{\sqrt{2\pi}}e^{x^2/2}$$
 
 6. Usar el algoritmo de Metropolis-Hastings para generar variadas aleatorias de una densidad Cauchy estándar. Descarta las primeras 1000 observaciones de la cadena, y comparar los deciles de las observaciones generadas con los deciles de la distribución Cauchy estándar. Recordar que una densidad $\text{Cauchy}(\theta,\eta)$ tiene densidad dada por la siguiente función:

$$f(x)=\frac{1}{\theta\pi\Big(1+\Big[\frac{x-\eta}{\theta}\Big]^2\Big)}, x\in\Re,\theta>0$$
 
 La densidad Cauchy tiene $\theta=1, \eta=0$, y corresponden a la densidad $t$ con un grado de libertad.

7. Implementar un muestreador de Metropolis de caminata aleatoria para generar muestras de una distribución estándar de Laplace:
$$f(x)=\frac{1}{2}e^{-|x|}, x\in\Re$$
Para el incremento, simula una normal estándar. Comparar las cadenas generadas cuando la distribución propuesta tiene diferentes varianzas. Calcular las tasas de aceptación de cada cadena.

8. Desarrollar un algoritmo de Metropolis-Hastings para muestrear de la distribución siguiente:

```{r echo=FALSE}
tabla = tibble(dado = c(1,2,3,4,5,6), probabilidad = c(0.01,0.39,0.11,0.18,0.26,0.05))
tabla %>% kable() %>% kable_paper(full_width = FALSE)
```

con la distribución propuesta basada en un dado honesto.

9. La sucesión de Fibonacci 1, 1, 2, 3, 5, 8, 13,... es descrita por recurrencia $f_n=f_{n-1}+f_{n-2}$, para $n\geq 3$ con $f_1=f_2=1$

a. Mostrar que el número de sucesiones binarias de longitud $m$ sin 1's adyacentes es $f_{m+2}$

b. Sea $p_{k,m}$ el número de sucesiones binarias de longitud $m$ con exactamente $k$ 1's. Mostrar que
$$p_{k,m}=\binom{m-k+1}{k}, k=0,1,...,\text{ceiling}(m/2)$$

